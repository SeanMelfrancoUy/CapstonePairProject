#Data Cleaning (Removing Outliers for the discrete variable tempo, liveness and energy and the continuous variable duration_ms)
remove_outliers <- function(data, variable, threshold = 1.5) {
  q1 <- quantile(data[[variable]], 0.25)
  q3 <- quantile(data[[variable]], 0.75)
  iqr <- q3 - q1
  lower_limit <- q1 - threshold * iqr
  upper_limit <- q3 + threshold * iqr
  data_filtered <- data[data[[variable]] >= lower_limit & data[[variable]] <= upper_limit, ]
  return(data_filtered)
}

#tempo
variable_to_remove_outliers <- "tempo"

SpotifyTracks_no_outliers <- remove_outliers(SpotifyTracks, variable_to_remove_outliers)

head(SpotifyTracks_no_outliers)

#liveness
variable_to_remove_outliers <- "liveness"

SpotifyTracks_no_outliers <- remove_outliers(SpotifyTracks, variable_to_remove_outliers)

head(SpotifyTracks_no_outliers)

#duration_ms
variable_to_remove_outliers <- "duration_ms"

SpotifyTracks_no_outliers <- remove_outliers(SpotifyTracks, variable_to_remove_outliers)

head(SpotifyTracks_no_outliers)

#energy
variable_to_remove_outliers <- "energy"

SpotifyTracks_no_outliers <- remove_outliers(SpotifyTracks, variable_to_remove_outliers)

head(SpotifyTracks_no_outliers)
